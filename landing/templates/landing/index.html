{% extends 'landing/base.html' %}
{% load static %}
{% load django_bootstrap5 %}

{% block content %}

<!-- Основной блок: Hero Section -->
<section id="about" class="text-white">
    <div class="container text-center">
        <h1>{{ about_block.title }}</h1>
        <div class="row mt-4 hero-content align-items-center">
            <div class="col-md-6 logo-column text-center text-md-start">
                <div class="d-flex flex-column align-items-center align-items-md-start">
                    <img src="/media/logos/LogoCTLABHD.png" alt="КТЛАБ" class="img-fluid mb-3" style="max-width: 300px;">
                    <a href="#contact-form" class="btn btn-primary btn-lg">Получить консультацию</a>
                </div>
            </div>
            <div class="col-md-6 text-column">
                <div class="text-in-frame">
                    <div class="frame-content">
                        <h3 class="frame-title">Отрабатывайте пилотирование в реальных условиях</h3>
                        <p class="frame-text">{{ about_block.text_in_frame }}</p>
                        <div class="frame-features">
                            <div class="frame-feature">
                                <i class="fas fa-map-marked-alt"></i>
                                <span>Разнообразные локации</span>
                            </div>
                            <div class="frame-feature">
                                <i class="fas fa-eye"></i>
                                <span>Режим от первого лица</span>
                            </div>
                            <div class="frame-feature">
                                <i class="fas fa-search"></i>
                                <span>Режим «Поиск»</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Трейлер -->
<section id="trailer" class="py-5 trailer-section">
    <div class="container">
        <div class="trailer-header text-center mb-5">
            <h2 class="trailer-title">{{ trailer.title }}</h2>
            <p class="trailer-subtitle">{{ trailer.subtitle }}</p>
        </div>
        <div class="row">
            <div class="col-lg-10 mx-auto">
                
                <div class="trailer-video-container">
                    <div class="video-wrapper">
                        {% if trailer.video_url %}
                            <iframe src="{{ trailer.video_url }}" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                        {% elif trailer.local_video %}
                             <video controls controlsList="nodownload" preload="metadata" poster="/media/backgrounds/hero_background.png">
                                <source src="{{ trailer.local_video.url }}#t=0.1" type="video/mp4">
                                Ваш браузер не поддерживает тег video.
                            </video>
                        {% else %}
                            <video controls controlsList="nodownload" preload="metadata" poster="/media/backgrounds/hero_background.png">
                                <source src="{% url 'stream_video' 'KTLABDEMO.mp4' %}#t=0.1" type="video/mp4">
                                Ваш браузер не поддерживает тег video.
                            </video>
                        {% endif %}
                    </div>
                </div>
                
                <div class="trailer-features mt-4">
                    <div class="row text-center">
                        <div class="col-md-3 mb-3">
                            <div class="feature-item">
                                <i class="fas fa-eye feature-icon"></i>
                                <h5>Режим от первого лица</h5>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="feature-item">
                                <i class="fas fa-map feature-icon"></i>
                                <h5>Разнообразные локации</h5>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="feature-item">
                                <i class="fas fa-cogs feature-icon"></i>
                                <h5>Реалистичная физика</h5>
                            </div>
                        </div>
                        <div class="col-md-3 mb-3">
                            <div class="feature-item">
                                <i class="fas fa-trophy feature-icon"></i>
                                <h5>Тренировка навыков</h5>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Блок информации о продукте -->
<section id="product-info" class="py-5 product-info-section">
    <div class="container">
        <div class="product-info-card">
            <div class="row g-0">
                <div class="col-lg-6">
                    <div class="product-info-image-container">
                        {% if product_info.image %}
                        <img src="{{ product_info.image.url }}" class="product-info-image" alt="Информация о продукте">
                        {% else %}
                        <img src="https://via.placeholder.com/600x400.png?text=Product+Image" class="product-info-image" alt="Информация о продукте">
                        {% endif %}
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="product-info-text">
                        <h2 class="product-info-title">{{ product_info.title }}</h2>
                        <p class="product-info-description">{{ product_info.description|linebreaksbr }}</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Галерея скриншотов -->
<section id="screenshots" class="py-5 screenshots-section">
    <div class="container">
        <div class="screenshots-header text-center mb-5">
            <h2 class="screenshots-title">{{ page_settings.gallery_title }}</h2>
            <p class="screenshots-subtitle">{{ page_settings.gallery_subtitle }}</p>
        </div>
        
        {% for album in screenshot_albums %}
        <div class="screenshot-album mb-5">
            <div class="album-header text-center mb-4">
                <h3 class="album-title">{{ album.title }}</h3>
                <div class="album-indicators">
                    <span class="indicator-dot active" data-bs-target="#carousel-{{ album.id }}" data-bs-slide-to="0"></span>
                    {% for screenshot in album.screenshots.all %}
                        {% if not forloop.first %}
                        <span class="indicator-dot" data-bs-target="#carousel-{{ album.id }}" data-bs-slide-to="{{ forloop.counter0 }}"></span>
                        {% endif %}
                    {% endfor %}
                </div>
            </div>
            
            <div class="screenshot-carousel-container">
                <div id="carousel-{{ album.id }}" class="carousel slide screenshot-carousel" data-bs-ride="carousel" data-bs-interval="5000">
                    <div class="carousel-inner">
                        {% for screenshot in album.screenshots.all %}
                            <div class="carousel-item {% if forloop.first %}active{% endif %}">
                                <div class="screenshot-item">
                                    <img src="{{ screenshot.image.url }}" class="d-block w-100" alt="{{ screenshot.caption }}">
                                    {% if screenshot.caption %}
                                        <div class="screenshot-caption">
                                            <p>{{ screenshot.caption }}</p>
                                        </div>
                                    {% endif %}
                                </div>
                            </div>
                        {% empty %}
                            <!-- Заглушка -->
                            <div class="carousel-item active">
                                <div class="screenshot-item">
                                    <img src="https://via.placeholder.com/1200x700.png?text={{ album.title }}+1" class="d-block w-100" alt="...">
                                    <div class="screenshot-caption">
                                        <p>Здесь будет скриншот из {{ album.title }}</p>
                                    </div>
                                </div>
                            </div>
                        {% endfor %}
                    </div>
                    
                    <button class="carousel-control-prev screenshot-control" type="button" data-bs-target="#carousel-{{ album.id }}" data-bs-slide="prev">
                        <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Previous</span>
                    </button>
                    <button class="carousel-control-next screenshot-control" type="button" data-bs-target="#carousel-{{ album.id }}" data-bs-slide="next">
                        <span class="carousel-control-next-icon" aria-hidden="true"></span>
                        <span class="visually-hidden">Next</span>
                    </button>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</section>

<!-- Скриншоты интерфейса -->
<section id="app-screenshots" class="py-5 app-screenshots-section">
    <div class="container">
        <div class="app-screenshots-header text-center mb-5">
            <h2 class="app-screenshots-title">{{ page_settings.app_gallery_title }}</h2>
            <p class="app-screenshots-subtitle">{{ page_settings.app_gallery_subtitle }}</p>
        </div>
        
        <div class="row">
            <div class="col-lg-8 mx-auto">
                <div class="app-screenshot-carousel-container">
                    <div id="app-screenshots-carousel" class="carousel slide app-screenshot-carousel" data-bs-ride="carousel" data-bs-interval="4000">
                        <div class="carousel-inner">
                            {% for screenshot in app_screenshots %}
                                <div class="carousel-item {% if forloop.first %}active{% endif %}">
                                    <div class="app-screenshot-item">
                                        <img src="{{ screenshot.image.url }}" class="d-block w-100" alt="{{ screenshot.title }}">
                                    </div>
                                </div>
                            {% empty %}
                                <!-- Заглушки для скриншотов интерфейса -->
                                <div class="carousel-item active">
                                    <div class="app-screenshot-item">
                                        <img src="https://via.placeholder.com/800x600.png?text=Главное+меню" class="d-block w-100" alt="Главное меню">
                                    </div>
                                </div>
                                <div class="carousel-item">
                                    <div class="app-screenshot-item">
                                        <img src="https://via.placeholder.com/800x600.png?text=Настройки+полета" class="d-block w-100" alt="Настройки полета">
                                    </div>
                                </div>
                                <div class="carousel-item">
                                    <div class="app-screenshot-item">
                                        <img src="https://via.placeholder.com/800x600.png?text=Выбор+локации" class="d-block w-100" alt="Выбор локации">
                                    </div>
                                </div>
                                <div class="carousel-item">
                                    <div class="app-screenshot-item">
                                        <img src="https://via.placeholder.com/800x600.png?text=Статистика" class="d-block w-100" alt="Статистика">
                                    </div>
                                </div>
                            {% endfor %}
                        </div>
                        
                        <button class="carousel-control-prev app-screenshot-control" type="button" data-bs-target="#app-screenshots-carousel" data-bs-slide="prev">
                            <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Previous</span>
                        </button>
                        <button class="carousel-control-next app-screenshot-control" type="button" data-bs-target="#app-screenshots-carousel" data-bs-slide="next">
                            <span class="carousel-control-next-icon" aria-hidden="true"></span>
                            <span class="visually-hidden">Next</span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Версии симулятора -->
<section id="versions" class="py-5 versions-section">
    <div class="container">
        <div class="versions-header text-center mb-5">
            <h2 class="versions-title">{{ page_settings.versions_title }}</h2>
            <p class="versions-subtitle">{{ page_settings.versions_subtitle }}</p>
        </div>
        <div class="row">
            {% for version in versions %}
            <div class="col-lg-6 mb-4">
                <div class="version-card version-card-{{ forloop.counter }}">
                    <div class="version-icon">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <div class="version-content">
                        <h4 class="version-title">{{ version.title }}</h4>
                        <p class="version-description">{{ version.description }}</p>
                        <div class="version-os">
                            <span class="os-label">Поддержка ОС:</span>
                            <div class="os-list">{{ version.supported_os }}</div>
                        </div>
                    </div>
                </div>
            </div>
            {% empty %}
            <!-- Заглушки -->
            <div class="col-lg-6 mb-4">
                <div class="version-card version-card-1">
                    <div class="version-icon">
                        <i class="fas fa-graduation-cap"></i>
                    </div>
                    <div class="version-content">
                        <h4 class="version-title">Базовая версия</h4>
                        <p class="version-description">Для школ, вузов, СПО, дополнительного образования. Подходит для обучения навыкам полета на квадрокоптерах весом до 30 кг и подготовки к решению определенных видов задач.</p>
                        <div class="version-os">
                            <span class="os-label">Поддержка ОС:</span>
                            <div class="os-list">Linux, Windows, macOS, РЕД ОС, Astra Linux, uncomOS</div>
                        </div>
                    </div>
                </div>
            </div>
             <div class="col-lg-6 mb-4">
                <div class="version-card version-card-2">
                    <div class="version-icon">
                        <i class="fas fa-cogs"></i>
                    </div>
                    <div class="version-content">
                        <h4 class="version-title">Кастомная версия</h4>
                        <p class="version-description">Разработка версии под ваши уникальные требования.</p>
                        <div class="version-os">
                            <span class="os-label">Поддержка ОС:</span>
                            <div class="os-list">Linux, Windows, macOS, РЕД ОС, Astra Linux, uncomOS</div>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>
</section>


<!-- Блок FPV режима -->
<section id="fpv-mode" class="py-5 fpv-section">
    <div class="container">
        <div class="fpv-content">
            <div class="row align-items-center">
                <div class="col-lg-6">
                    <div class="fpv-image-container">
                        {% if fpv_mode.image %}
                            <img src="{{ fpv_mode.image.url }}" class="fpv-image" alt="FPV режим">
                        {% else %}
                            <!-- Заглушка -->
                            <img src="https://via.placeholder.com/600x400.png?text=FPV+режим" class="fpv-image" alt="FPV режим">
                        {% endif %}
                        <div class="fpv-overlay">
                            <div class="fpv-play-button">
                                <i class="fas fa-play"></i>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-6">
                    <div class="fpv-text-content">
                        <div class="fpv-badge">
                            <i class="fas fa-eye"></i>
                            <span>FPV режим</span>
                        </div>
                        <h2 class="fpv-title">{{ fpv_mode.title|default:"FPV режим" }}</h2>
                        <p class="fpv-description">{{ fpv_mode.description }}</p>
                        <div class="fpv-features">
                            <div class="fpv-feature">
                                <i class="fas fa-vr-cardboard"></i>
                                <span>Режим от первого лица</span>
                            </div>
                            <div class="fpv-feature">
                                <i class="fas fa-cogs"></i>
                                <span>Реалистичная физика</span>
                            </div>
                            <div class="fpv-feature">
                                <i class="fas fa-trophy"></i>
                                <span>Тренировка навыков</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Варианты приобретения -->
<section id="purchase-options" class="py-5 purchase-section">
    <div class="container">
        <div class="purchase-header text-center mb-5">
            <h2 class="purchase-title">{{ page_settings.purchase_options_title }}</h2>
            <p class="purchase-subtitle">{{ page_settings.purchase_options_subtitle }}</p>
        </div>
        <div class="row justify-content-center">
            {% for option in purchase_options %}
            <div class="col-lg-5 mb-4">
                <div class="purchase-card purchase-card-{{ forloop.counter }}">
                    <div class="purchase-header-card">
                        <div class="purchase-icon">
                                <i class="fas fa-{% if forloop.first %}star{% else %}crown{% endif %}"></i>
                                </div>
                               <h4 class="purchase-name">{{ option.name }}</h4>
                           </div>
                           <div class="purchase-price">
                            <span class="price-amount">{{ option.price }}</span>
                        {% if not option.is_custom %}
                        <span class="price-period">/лицензия</span>
                    {% endif %}
                </div>
                <div class="purchase-features">
                        {% for feature in option.get_features_list %}
                            <div class="feature-item">
                                <i class="fas fa-check"></i>
                                <span>{{ feature }}</span>
                            </div>
                        {% endfor %}
                                </div>
                                <a href="#contact" class="purchase-btn">
                                    <span>Заказать</span>
                                    <i class="fas fa-arrow-right"></i>
                                </a>
                            </div>
                        </div>
                         {% empty %}
                         <!-- Заглушки -->
                         <div class="col-lg-5 mb-4">
                            <div class="purchase-card purchase-card-1">
                                <div class="purchase-header-card">
                                    <div class="purchase-icon">
                                        <i class="fas fa-star"></i>
                                    </div>
                                    <h4 class="purchase-name">Базовая версия</h4>
                                </div>
                                <div class="purchase-price">
                                    <span class="price-amount">5000 руб</span>
                                    <span class="price-period">/лицензия</span>
                                </div>
                                <div class="purchase-features">
                                    <div class="feature-item">
                                        <i class="fas fa-check"></i>
                                        <span>Полный доступ к симулятору</span>
                                    </div>
                                    <div class="feature-item">
                                        <i class="fas fa-check"></i>
                                        <span>Все локации и режимы</span>
                                    </div>
                                    <div class="feature-item">
                                        <i class="fas fa-check"></i>
                                        <span>Техническая поддержка</span>
                                    </div>
                                </div>
                                <a href="#contact" class="purchase-btn">
                                    <span>Заказать</span>
                                    <i class="fas fa-arrow-right"></i>
                                </a>
                            </div>
                        </div>
                         <div class="col-lg-5 mb-4">
                            <div class="purchase-card purchase-card-2">
                                <div class="purchase-header-card">
                                    <div class="purchase-icon">
                                        <i class="fas fa-crown"></i>
                                    </div>
                                    <h4 class="purchase-name">Кастомная версия</h4>
                                </div>
                                <div class="purchase-price">
                                    <span class="price-amount">Цена по запросу</span>
                                </div>
                                <div class="purchase-features">
                                    <div class="feature-item">
                                        <i class="fas fa-check"></i>
                                        <span>Индивидуальная разработка</span>
                                    </div>
                                    <div class="feature-item">
                                        <i class="fas fa-check"></i>
                                        <span>Персональные настройки</span>
                                    </div>
                                    <div class="feature-item">
                                        <i class="fas fa-check"></i>
                                        <span>Приоритетная поддержка</span>
                                    </div>
                                </div>
                                <a href="#contact" class="purchase-btn">
                                    <span>Заказать</span>
                                    <i class="fas fa-arrow-right"></i>
                                </a>
                            </div>
                        </div>
                         {% endfor %}
                    </div>
                </div>
            </section>


<!-- Форма заявки -->
<section id="contact" class="py-5 contact-section-new">
    <div class="container">
        <div class="contact-header text-center mb-5">
            <h2 class="contact-title">Свяжитесь с нами</h2>
            <p class="contact-subtitle">Мы всегда готовы ответить на ваши вопросы и обсудить сотрудничество.</p>
        </div>
        <div class="row justify-content-center">
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="contact-card">
                    <div class="contact-icon"><i class="fas fa-phone"></i></div>
                    <h3 class="contact-card-title">Телефон</h3>
                    <p class="contact-card-text">{{ footer.phone }}</p>
                    <a href="tel:{{ footer.phone|cut:' '|cut:'-'|cut:'(' |cut:')' }}" class="contact-card-link">Позвонить</a>
                </div>
            </div>
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="contact-card">
                    <div class="contact-icon"><i class="fas fa-envelope"></i></div>
                    <h3 class="contact-card-title">Электронная почта</h3>
                    <p class="contact-card-text">{{ footer.email }}</p>
                    <a href="mailto:{{ footer.email }}" class="contact-card-link">Написать</a>
                </div>
            </div>
            <div class="col-lg-4 col-md-6 mb-4">
                <div class="contact-card">
                    <div class="contact-icon"><i class="fas fa-map-marker-alt"></i></div>
                    <h3 class="contact-card-title">Адрес</h3>
                    <p class="contact-card-text">Россия, Москва</p>
                    <a href="https://yandex.ru/maps/213/moscow/" target="_blank" class="contact-card-link">Показать на карте</a>
                </div>
            </div>
        </div>
    </div>
</section>

{% endblock %}
